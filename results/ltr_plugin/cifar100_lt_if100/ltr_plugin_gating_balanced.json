{
  "objectives": [
    "balanced",
    "worst_group"
  ],
  "description": "CORRECTED: Targeted rejection grid (0.0..0.8) with val-based hyperparameter selection per paper Algorithm 1. Uses 3 experts with gating network.",
  "method": "plug-in_balanced_val_selection_gating",
  "hyperparameter_selection": "val_based",
  "algorithm": "Algorithm 1 from paper - optimize (\u03b1,\u03bc) on tunev, select \u03bc on val",
  "experts": [
    "ce_baseline",
    "logitadjust_baseline",
    "balsoftmax_baseline"
  ],
  "results_per_cost": [
    {
      "target_rejection": 0.0,
      "cost_val": 18.03052520751953,
      "cost_test": 20.99636459350586,
      "alpha": [
        1.9400074333784052,
        0.05998282437499089
      ],
      "mu": [
        0.0,
        -2.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.5328230007431736,
        "worst_group_error": 0.6002565893375112,
        "coverage": 0.999000072479248,
        "rejection_rate": 0.0009999275207519531,
        "group_errors": [
          0.6002565893375112,
          0.46538941214883583
        ]
      },
      "test_metrics": {
        "balanced_error": 0.5200311390488394,
        "worst_group_error": 0.6072074673915095,
        "coverage": 0.9998750686645508,
        "rejection_rate": 0.00012493133544921875,
        "group_errors": [
          0.6072074673915095,
          0.4328548107061692
        ]
      }
    },
    {
      "target_rejection": 0.1,
      "cost_val": 1.9437530040740967,
      "cost_test": 1.780566692352295,
      "alpha": [
        1.7886598858734981,
        0.05281192864426446
      ],
      "mu": [
        0.0,
        23.5
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.49659835646611244,
        "worst_group_error": 0.5798066859888722,
        "coverage": 0.9000000357627869,
        "rejection_rate": 0.09999996423721313,
        "group_errors": [
          0.5798066859888722,
          0.4133900269433527
        ]
      },
      "test_metrics": {
        "balanced_error": 0.48365046978448345,
        "worst_group_error": 0.5814587540383428,
        "coverage": 0.9000000357627869,
        "rejection_rate": 0.09999996423721313,
        "group_errors": [
          0.5814587540383428,
          0.38584218553062405
        ]
      }
    },
    {
      "target_rejection": 0.2,
      "cost_val": 2.2828421592712402,
      "cost_test": 2.2329583168029785,
      "alpha": [
        1.596193533684096,
        0.04495977664582476
      ],
      "mu": [
        0.0,
        23.25
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.4587358619877711,
        "worst_group_error": 0.5440846325835055,
        "coverage": 0.7990000247955322,
        "rejection_rate": 0.20099997520446777,
        "group_errors": [
          0.5440846325835055,
          0.37338709139203674
        ]
      },
      "test_metrics": {
        "balanced_error": 0.44978097898436364,
        "worst_group_error": 0.5552763798773515,
        "coverage": 0.800000011920929,
        "rejection_rate": 0.19999998807907104,
        "group_errors": [
          0.5552763798773515,
          0.3442855780913759
        ]
      }
    },
    {
      "target_rejection": 0.3,
      "cost_val": 6.4856462478637695,
      "cost_test": 6.604101181030273,
      "alpha": [
        1.5179403955859883,
        0.032802659762977374
      ],
      "mu": [
        0.0,
        11.25
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.43402837092024005,
        "worst_group_error": 0.5540966045550386,
        "coverage": 0.7000000476837158,
        "rejection_rate": 0.2999999523162842,
        "group_errors": [
          0.5540966045550386,
          0.3139601372854414
        ]
      },
      "test_metrics": {
        "balanced_error": 0.4317502899437904,
        "worst_group_error": 0.5661066243396934,
        "coverage": 0.7000000476837158,
        "rejection_rate": 0.2999999523162842,
        "group_errors": [
          0.5661066243396934,
          0.2973939555478874
        ]
      }
    },
    {
      "target_rejection": 0.4,
      "cost_val": 2.9827699661254883,
      "cost_test": 3.109747886657715,
      "alpha": [
        1.2922585269838396,
        0.029920142457961527
      ],
      "mu": [
        0.0,
        23.5
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.3705390972009495,
        "worst_group_error": 0.46458613336881305,
        "coverage": 0.6000000238418579,
        "rejection_rate": 0.3999999761581421,
        "group_errors": [
          0.46458613336881305,
          0.276492061033086
        ]
      },
      "test_metrics": {
        "balanced_error": 0.36782754447741706,
        "worst_group_error": 0.4836736373479691,
        "coverage": 0.6000000238418579,
        "rejection_rate": 0.3999999761581421,
        "group_errors": [
          0.4836736373479691,
          0.2519814516068651
        ]
      }
    },
    {
      "target_rejection": 0.5,
      "cost_val": 3.9417381286621094,
      "cost_test": 3.9346132278442383,
      "alpha": [
        1.169379211937345,
        0.021443418020254963
      ],
      "mu": [
        0.0,
        22.75
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.32082296738656624,
        "worst_group_error": 0.44843655905525764,
        "coverage": 0.5,
        "rejection_rate": 0.5,
        "group_errors": [
          0.44843655905525764,
          0.1932093757178748
        ]
      },
      "test_metrics": {
        "balanced_error": 0.32723265710113475,
        "worst_group_error": 0.4536779304252221,
        "coverage": 0.5001250505447388,
        "rejection_rate": 0.49987494945526123,
        "group_errors": [
          0.4536779304252221,
          0.2007873837770474
        ]
      }
    },
    {
      "target_rejection": 0.6,
      "cost_val": 5.6403374671936035,
      "cost_test": 5.678308963775635,
      "alpha": [
        1.0188551018152787,
        0.014262592398281097
      ],
      "mu": [
        0.0,
        14.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.2621949657454087,
        "worst_group_error": 0.4098861170201833,
        "coverage": 0.4010000228881836,
        "rejection_rate": 0.5989999771118164,
        "group_errors": [
          0.4098861170201833,
          0.11450381447063407
        ]
      },
      "test_metrics": {
        "balanced_error": 0.29326169182345163,
        "worst_group_error": 0.430327782748177,
        "coverage": 0.40012502670288086,
        "rejection_rate": 0.5998749732971191,
        "group_errors": [
          0.430327782748177,
          0.1561956008987262
        ]
      }
    },
    {
      "target_rejection": 0.7,
      "cost_val": 3.7543728351593018,
      "cost_test": 4.027919769287109,
      "alpha": [
        0.7977713034488529,
        0.011179917265719147
      ],
      "mu": [
        0.0,
        20.75
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.16591509171214996,
        "worst_group_error": 0.2926510800718891,
        "coverage": 0.30100002884864807,
        "rejection_rate": 0.6989999711513519,
        "group_errors": [
          0.2926510800718891,
          0.039179103352410836
        ]
      },
      "test_metrics": {
        "balanced_error": 0.20295016409772054,
        "worst_group_error": 0.30475714107754737,
        "coverage": 0.30012500286102295,
        "rejection_rate": 0.699874997138977,
        "group_errors": [
          0.30475714107754737,
          0.10114318711789369
        ]
      }
    },
    {
      "target_rejection": 0.8,
      "cost_val": 3.092249870300293,
      "cost_test": 3.4609413146972656,
      "alpha": [
        0.585998065684784,
        0.007465902640870414
      ],
      "mu": [
        0.0,
        20.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.07754363444844437,
        "worst_group_error": 0.15508726889688873,
        "coverage": 0.20100000500679016,
        "rejection_rate": 0.7989999949932098,
        "group_errors": [
          0.15508726889688873,
          0.0
        ]
      },
      "test_metrics": {
        "balanced_error": 0.12045698746157962,
        "worst_group_error": 0.18012966265594865,
        "coverage": 0.20012500882148743,
        "rejection_rate": 0.7998749911785126,
        "group_errors": [
          0.18012966265594865,
          0.0607843122672106
        ]
      }
    }
  ],
  "rc_curve": {
    "val": {
      "rejection_rates": [
        0.0009999275207519531,
        0.09999996423721313,
        0.20099997520446777,
        0.2999999523162842,
        0.3999999761581421,
        0.5,
        0.5989999771118164,
        0.6989999711513519,
        0.7989999949932098
      ],
      "balanced_errors": [
        0.5328230007431736,
        0.49659835646611244,
        0.4587358619877711,
        0.43402837092024005,
        0.3705390972009495,
        0.32082296738656624,
        0.2621949657454087,
        0.16591509171214996,
        0.07754363444844437
      ],
      "worst_group_errors": [
        0.6002565893375112,
        0.5798066859888722,
        0.5440846325835055,
        0.5540966045550386,
        0.46458613336881305,
        0.44843655905525764,
        0.4098861170201833,
        0.2926510800718891,
        0.15508726889688873
      ],
      "tail_minus_head": [
        -0.1348671771886754,
        -0.1664166590455195,
        -0.17069754119146874,
        -0.2401364672695972,
        -0.18809407233572706,
        -0.2552271833373828,
        -0.2953823025495492,
        -0.2534719767194783,
        -0.15508726889688873
      ],
      "aurc_balanced": 0.28062689495642434,
      "aurc_worst_group": 0.3661156679490127,
      "aurc_balanced_coverage_ge_0_2": 0.28062689495642434,
      "aurc_worst_group_coverage_ge_0_2": 0.3661156679490127
    },
    "test": {
      "rejection_rates": [
        0.00012493133544921875,
        0.09999996423721313,
        0.19999998807907104,
        0.2999999523162842,
        0.3999999761581421,
        0.49987494945526123,
        0.5998749732971191,
        0.699874997138977,
        0.7998749911785126
      ],
      "balanced_errors": [
        0.5200311390488394,
        0.48365046978448345,
        0.44978097898436364,
        0.4317502899437904,
        0.36782754447741706,
        0.32723265710113475,
        0.29326169182345163,
        0.20295016409772054,
        0.12045698746157962
      ],
      "worst_group_errors": [
        0.6072074673915095,
        0.5814587540383428,
        0.5552763798773515,
        0.5661066243396934,
        0.4836736373479691,
        0.4536779304252221,
        0.430327782748177,
        0.30475714107754737,
        0.18012966265594865
      ],
      "tail_minus_head": [
        -0.17435265668534033,
        -0.19561656850771875,
        -0.21099080178597557,
        -0.268712668791806,
        -0.231692185741104,
        -0.2528905466481747,
        -0.2741321818494508,
        -0.20361395395965368,
        -0.11934535038873806
      ],
      "aurc_balanced": 0.2875636390594192,
      "aurc_worst_group": 0.3767618362849853,
      "aurc_balanced_coverage_ge_0_2": 0.2875636390594192,
      "aurc_worst_group_coverage_ge_0_2": 0.3767618362849853
    }
  }
}